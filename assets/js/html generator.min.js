const sPrem='<img src="assets/img/premium-32.png" class="smallIcon" />',sPrev='<img src="assets/img/preview-32.png" class="smallIcon" />',sIconW='<span style="color:orange">&#9888;</span>',sIconR='<span style="color:red">&#10006;</span>',isTrue=e=>!0==e;function generateReport(e,t,a,r){let n=0,o=0,l="",c="";(null==r||void 0==r||""==r)&&(r=e.name),!e.exceptionHandleScope&&o++,!e.exceptionScope&&o++,!e.mainScope&&o++,1==e.composes?n+=e.composes:e.composes>2&&o++;let d="<p>Com:"+oConfigReference.complexity+" | Rat:"+oConfigReference.ratings+" | Nam:"+oConfigReference.naming+" | Sco:"+oConfigReference.score+"</p>",s=[e.varNameUse,e.varNaming].every(isTrue)||0==e.variables;t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace("{flowName}",r)).replace("{flowId}",e.id)).replace("{owner}",e.owner)).replace("{variable}",s)).replace("{exception}",e.exceptionScope&&e.exceptionTerminate&&e.exceptionLink)).replace("{main}",e.mainScope)).replace("{composes}",e.composes)).replace("{date}",getToday())).replace("{complexity}",e.complexity),e.premium&&(c=sPrem),t=t.replace("{premium}",c),a=(a=(a=(a=a.replace("{flowName}",r)).replace("{flowId}",e.id)).replace("{owner}",e.owner)).replace("{date}",getToday()),e.complexity>oRatings.complexityRe?(t=t.replace('id="complexity" style="text-align: center; background-color:green;','id="complexity" style="text-align: center; background-color:red;'),n++):e.complexity>oRatings.complexityAm&&(t=t.replace('id="complexity" style="text-align: center; background-color:green;','id="complexity" style="text-align: center; background-color:orange;'),o++),t=t.replace("{actions}",e.steps),e.steps>oRatings.actionRe?(t=t.replace('id="actions" style="text-align: center; background-color:green;','id="actions" style="text-align: center; background-color:red;'),n++):e.steps>oRatings.actionsAm&&(t=t.replace('id="actions" style="text-align: center; background-color:green;','id="actions" style="text-align: center; background-color:orange;'),o++),t=t.replace("{variables}",e.variables),e.variables>oRatings.variablesRe?(t=t.replace('id="variables" style="text-align: center; background-color:green;','id="variables" style="text-align: center; background-color:red;'),n++):e.variables>oRatings.variablesAm&&(t=t.replace('id="variables" style="text-align: center; background-color:green;','id="variables" style="text-align: center; background-color:orange;'),o++),t=t.replace("{exceptions}",e.exception),e.exception<=oRatings.exceptionsRe?(t=t.replace('id="exceptions" style="text-align: center; background-color:green;','id="exceptions" style="text-align: center; background-color:red;'),n++):e.exception<oRatings.exceptions&&(t=t.replace('id="exceptions" style="text-align: center; background-color:green;','id="exceptions" style="text-align: center; background-color:orange;'),o++);let p='<table class="mui-table mui-table--bordered" id="variablesTable" ><thead><tr><th>Name</th><th>Type</th><th>Value</th><th>Used</th><th>Named</th><th>Constant</th></tr></thead><tbody>';e.variableArray.forEach(e=>{l="",e.local||(n++,l=sIconW),e.used||(o++,l=sIconR),e.named||(o++,l=sIconR),p+="<tr><td>"+l+" "+e.name+"</td><td>"+e.type+"</td><td><div contentEditable='true' style='overflow-y:auto; resize:both; background-color:white;'><pre>"+inputFormat(e.value)+"</pre></div></td><td>"+e.used+"</td><td>"+e.named+"</td><td>"+e.local+"</td></tr>"}),p+="</tbody></table>",t=t.replace("{variablesTable}",p),a=a.replace("{variablesTable}",p);let h='<table class="mui-table mui-table--bordered"><thead><tr><th>Action</th><th>Name</th><th>Runafter</th></tr></thead><tbody>';e.exceptionArray.forEach(e=>{l="",e.runAfter.includes("TimedOut")||(o++,l=sIconR),h+="<tr><td>"+l+" "+e.step+"</td><td>"+e.name+"</td><td>"+e.runAfter+"</td></tr>"}),h+="</tbody></table>",t=t.replace("{exceptionsTable}",h),a=a.replace("{exceptionsTable}",h);let m='<table class="mui-table mui-table--bordered" id="actionTable"><thead><tr><th style="max-width:24%">Name</th><th style="max-width:24%">Type</th><th style="max-width:24%">Run After</th><th style="max-width:24%">Notes</th><th>Nested</th><th>Id</th></tr></thead><tbody>';for(i=0;i<e.actionArray.length;i++)m+="<tr><td id='"+e.actionArray[i].hashId+"'><a href='#"+e.actionArray[i].hashId+"-IN'>"+e.actionArray[i].name+"</a></td><td>"+apiLink(e.actionArray[i].type,e.actionArray[i].step,e.actionArray[i].hashId)+"</td><td>"+e.actionArray[i].runAfter+"</td><td><div contentEditable='true' style='max-height=100px; overflow-y:auto; resize:vertical;'><pre>"+e.actionArray[i].notes.replaceAll("<","-").replaceAll("\xa3$","")+"</pre></div></td><td>"+e.actionArray[i].nested+"</td><td>"+e.actionArray[i].index+"</td></tr>";m+="</tbody></table>",t=t.replace("{actionsTable}",m),a=a.replace("{actionsTable}",m);let b='<table class="mui-table mui-table--bordered" id="inputTable"><thead><tr><th style="width:24%">Name</th><th style="width:14%">Type</th><th style="width:8%">Secure</th><th style="width:6%">Env</th><th>Inputs</th></tr></thead><tbody>';e.actionArray.forEach(e=>b+="<tr><td id='"+e.hashId+"-IN'><a href='#"+e.hashId+"'>"+e.name+"</a></td><td>"+e.step+"</td><td>"+e.secure.replace(",","<br>")+"</td><td>"+e.environmentB+"</td><td><div contentEditable='true' style='max-height=100px; overflow-y:auto; resize:vertical;'><pre>"+inputFormat(e.detail)+"</pre></div></td></tr>"),b+="</tbody></table>",t=t.replace("{inputTable}",b),a=a.replace("{inputTable}",b);let u='<table class="mui-table mui-table--bordered"><thead><tr><th>Name</th><th>Id</th><th>Count</th></tr></thead><tbody>';e.connectionArray.forEach(e=>u+="<tr><td>"+e.conName+'</td><td style="max-width:200px">'+e.appId+"</td><td>"+e.count+"</td></tr>"),u+="</tbody></table>",t=t.replace("{connectionsTable}",u),a=a.replace("{connectionsTable}",u);let y='<table class="mui-table mui-table--bordered" id="apiTable"><thead><tr><th>Name</th><th>Type</th><th>Connector</th><th>Filter</th><th>Pagination</th><th>Retry</th></tr></thead><tbody>';e.apiActionArray.forEach(e=>{l="",""==e.filter&&"GetItems"==e.step&&(n++,l=sIconW),""==e.pagination&&("GetItems"==e.step||e.step.includes("ListMyTasks"))&&(n++,l=sIconW),""==e.retry&&"PatchItem"==e.step&&(n++,l=sIconW),"Standard"!=e.tier&&(""!=l&&(l+=" "),"Premium"==e.tier&&(l+=sPrem)),y+="<tr><td id='"+e.hashId+"-API'><a href='#"+e.hashId+"'>"+l+" "+e.name+"</td><td>"+e.step+'</td><td style="max-width:200px">'+e.connector+'</td><td style="max-width:200px; max-height:100px; overflow-y:auto;">'+e.filter+"</td><td>"+e.pagination+'</td><td style="max-width:200px; max-height:100px; overflow-y:auto;">'+e.retry+"</td></tr>"}),y+="</tbody></table>",t=t.replace("{apiTable}",y),a=a.replace("{apiTable}",y);let g=rating(e),x='<div style="background-color:#EEEEEE"><div style="width:'+g+'%; background-color:{barColour}; color:white; text-align:center">'+g+"</div></div>";x=g<75?x.replace("{barColour}","red"):g<90?x.replace("{barColour}","orange"):x.replace("{barColour}","green"),x+='<table class="mui-table mui-table--bordered"><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><h2>Warnings</h2></td><td><h2>'+n+"</h2></td></tr><tr><td><h2>Failures</h2></td><td><h2>"+o+"</h2></td></tr></tbody></table>",t=t.replace("{ratingBar}",x);let f="<div style='padding-left:10px'<b>Type: "+e.trigger+"</b><br><p><b>Data: </b>"+e.triggerData+"</b><br><p><b>Parameters: </b>"+e.triggerParam.replaceAll("\xa3$","")+"</p><p><b>Configuration:</b> "+e.triggerConfig.replaceAll("\xa3$","")+"</p><b>Inputs:</b> "+e.triggerInputs.replaceAll("\xa3$","")+"</p><p><b>Recurrence: </b>"+e.triggerRecur+"</p><p><b>Expressions:</b> "+e.triggerExpress+"</p></div>";t=t.replace("{trigger}",f),a=a.replace("{trigger}",f);let v="";return e.actionArray.filter(e=>""!=e.notes&&null!=e.notes).forEach(e=>{v+=e.name+": "+e.notes+"\n"}),{review:t=t.replace("{connectorsTable}",""),report:a=(a=(a=a.replace("{connectorsTable}","")).replaceAll(sIconW,"")).replaceAll(sIconR,""),references:d}}function checkRatings(e){return!!(Object.hasOwn(e,"complexityAm")&&Object.hasOwn(e,"complexityRe")&&Object.hasOwn(e,"actionsAm")&&Object.hasOwn(e,"actionsRe")&&Object.hasOwn(e,"variablesAm")&&Object.hasOwn(e,"variablesRe")&&Object.hasOwn(e,"exceptionsAm")&&Object.hasOwn(e,"exceptionsRe"))}function rating(e){let t=0;e.exceptionScope&&e.exceptionTerminate&&e.exceptionLink&&(t+=aScoring.find(e=>"exceptionScope"==e.Name).Score),e.mainScope&&(t+=aScoring.find(e=>"mainScope"==e.Name).Score),e.varNaming&&(t+=aScoring.find(e=>"varNaming"==e.Name).Score),e.varNameUse&&(t+=aScoring.find(e=>"varUsed"==e.Name).Score),e.varNameConsts&&(t+=aScoring.find(e=>"varConstant"==e.Name).Score);let a=aScoring.find(e=>"composes"==e.Name).Score-e.composes*aScoring.find(e=>"composesDeduction"==e.Name).Score;a<0&&(a=0),t+=a;let r=aScoring.find(e=>"variables"==e.Name).Score-e.variables*aScoring.find(e=>"variablesDeduction"==e.Name).Score;r<0&&(r=0),t+=r;let n;(n=e.connectionRefs>aScoring.find(e=>"connectionsMin"==e.Name).Score?aScoring.find(e=>"connections"==e.Name).Score-(e.connectionRefs-aScoring.find(e=>"connectionsMin"==e.Name).Score)*aScoring.find(e=>"connectionsDeduction"==e.Name).Score:aScoring.find(e=>"connections"==e.Name).Score)<0&&(n=0),t+=n;let o=aScoring.find(e=>"complexityGreen"==e.Name).Score;e.complexity>oRatings.complexityRe?o=aScoring.find(e=>"complexityRed"==e.Name).Score:e.complexity>oRatings.complexityAm&&(o=aScoring.find(e=>"complexityAmber"==e.Name).Score),t+=o;let l=aScoring.find(e=>"actionsGreen"==e.Name).Score;return e.steps>oRatings.actionRe?l=aScoring.find(e=>"actionsAmber"==e.Name).Score:e.steps>oRatings.actionsAm&&(l=aScoring.find(e=>"actionsAmber"==e.Name).Score),t+=l}function getToday(){let e=new Date;return[e.getFullYear(),e.getMonth()+1,e.getDate()].join("/")}function apiLink(e,t,a){return"OpenApiConnection"==e?"<a href='#"+a+"-API'>"+t+"</a>":t}function inputFormat(e){if(void 0==e||null==e)return"";let t=e.replaceAll("<","&lt;").replaceAll("\xa3$","");return(t=(t=(t=t.replace(/\\n/g,"\n")).replace(/\\r/g,"")).replace(/\\t/g,"")).replaceAll("{","{ \n").replaceAll("}","} \n")}function listSolution(e,t,a,r){let n=t,o="",l="",c="";n=(n=(n=(n=n.replace("{flowName}",oDependencies.ImportExportXml.SolutionManifest.UniqueName)).replace("{flowId}",oDependencies.ImportExportXml.SolutionManifest.Version)).replace("{owner}",oDependencies.ImportExportXml.SolutionManifest.Publisher.UniqueName)).replace("{date}",getToday());let d='<table class="mui-table mui-table--bordered" id="flowTable" ><thead><tr><th>Name</th><th>Trigger</th><th>Premium</th><th>Actions</th><th>Variables</th></tr></thead><tbody>',s='<table class="mui-table mui-table--bordered" id="connectorTable" ><thead><tr><th>Name</th><th>Description</th><th>Host</th></tr></thead><tbody>';if(a.forEach(e=>{d+="<tr><td>"+e.name+"</td><td>"+e.trigger+"</td><td>"+e.premium+"</td><td>"+e.steps+"</td><td>"+e.variables+"</td><tr>"}),d+="</table>",r.forEach(e=>{s+="<tr><td>"+e.name+"</td><td>"+e.description+"</td><td>"+e.host+"</td><tr>"}),s+="</table>",e.ConnectionRefs.length>0&&(c='<table class="mui-table mui-table--bordered"><thead><tr><th>Name</th><th>Type</th><th>id</th><th>Cusomizable</th></tr></thead><tbody>',e.ConnectionRefs.forEach(e=>{let t="";e.connectorid&&(t=e.connectorid.split("/apis/")[1]);let a=1==e.iscustomizable;c=c+"<tr><td>"+e.connectionreferencedisplayname+"</td><td>"+t+"</td><td>"+e.connectionreferencelogicalname+"</td><td>"+a+"</td></tr>"}),c+="</tbody></table>"),oDependencies?.ImportExportXml?.SolutionManifest?.MissingDependencies?.MissingDependency!=void 0){let p=oDependencies.ImportExportXml.SolutionManifest.MissingDependencies.MissingDependency;if(p){let h=[];Array.isArray(p)?h=p:h.push(p),o='<table class="mui-table mui-table--bordered"><thead><tr><th>Name</th><th>Type</th><th>Dependent</th></tr></thead><tbody>',h.forEach(e=>{o=o+"<tr><td>"+e.Required.displayName+"</td><td>"+e.Required.type+"</td><td>"+e.Dependent.displayName+"</td></tr>"}),o+="</tbody></table>"}}return aEnvironmentVar.length>0&&(l='<table class="mui-table mui-table--bordered"><thead><tr><th>Name</th><th>Type</th><th>Cusomizable</th></tr></thead><tbody>',aEnvironmentVar.forEach(e=>{let t=1==e.environmentvariabledefinition.iscustomizable,a="",r="";e?.environmentvariabledefinition?.displayname?.default!=void 0&&(a=e.environmentvariabledefinition.displayname.default),e?.environmentvariabledefinition?.type!=void 0&&(r=e.environmentvariabledefinition.type),l=l+"<tr><td>"+a+"</td><td>"+r+"</td><td>"+t+"</td></tr>"}),l+="</tbody></table>"),n=(n=(n=(n=(n=(n=n.replace("{flowsTable}",d)).replace("{connectionsTable}",c)).replace("{variablesTable}",l)).replace("{dependenciesTable}",o)).replace("{connectorsTable}",s)).replace("{json}",JSON.stringify(e,void 0,2))}